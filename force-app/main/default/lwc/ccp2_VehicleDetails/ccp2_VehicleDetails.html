<template>
    <template if:true={showvehDetails}>
        <div class="main_container">
            <div class="main_container">
                <template if:true={vehicleByIdLoader}>
                    <div
                        style="position: relative; width:100%; height:550px; display:flex; justify-content:center; align-items:center;">
                        <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                    </div>
                </template>
    
                <template if:false={vehicleByIdLoader}>
                    <div class="content1_container">
                        <div class="content1_left_container">
                            <div class="content1_left_row1">
                                <div class="content1_left_row1_left">
                                    <lightning-icon icon-name='utility:chevronleft' class="back-icon"
                                        alternative-text='chevronleft' size='x-small' onclick={closeDetailPage}
                                        title='chevronleft'></lightning-icon>
                                    <h1 class="RegNoData">{vehicleByIdData.vehicleNumber}</h1>
                                </div>
                                <!-- <div class="buttons">
                                    <div class="btnico">
                                        <lightning-icon icon-name='utility:note' alternative-text='note' size='x-small'
                                            title='note' class="i"></lightning-icon>
                                        <span class="notetext">{label.CCP2_ScheduleRegistration}</span>
                                    </div>
                                    <div class="btnico1">
                                        <lightning-icon icon-name='utility:date_input' alternative-text='date_input'
                                            size='x-small' title='date_input' class="i"></lightning-icon>
                                        <span class="notetext">{label.CCP2_ExpenseRegistration}</span>
                                    </div>
                                </div> -->
                            </div>
                            <div class="content1_left_row2">
                                <div class="content1_left_row2_1">
                                    <div class="content1_left_row2_element">
                                        <h4 class="Head">登録番号</h4>
                                        <p class="recdata">{vehicleByIdData.registerationNumber}</p>
                                    </div>
                                    <div class="content1_left_row2_element">
                                        <h4 class="Head">車名</h4>
                                        <p class="recdata">{vehicleByIdData.name}</p>
                                    </div>
                                    <div class="content1_left_row2_element">
                                        <h4 class="Head">自動車の種別</h4>
                                        <p class="recdata">{vehicleByIdData.type}</p>
                                    </div>
                                    <div class="content1_left_row2_element">
                                        <h4 class="Head">走行距離</h4>
                                        <p class="recdata">{vehicleByIdData.mileage}km</p>
                                    </div>
                                    <div class="content1_left_row2_element">
                                        <h4 class="Head">車検証有効期限</h4>
                                        <p class="recdata">{vehicleByIdData.expirationDate}</p>
                                    </div>
    
    
                                </div>
    
                                <div class="content1_left_row2_2">
                                    <div class="content1_left_left_row3">
                                        <lightning-icon icon-name={starIcon} class="back-icon" alternative-text="Star"
                                            size="x-small" onclick={toggleStar}></lightning-icon>
                                        <p class="back-icon">お気に入り</p>
                                    </div>
                                    <div class="content1_left_row3">
                                        <button onclick={gotoMaintainencePage}>予定登録</button>
                                        <button>費用登録</button>
                                    </div>
                                </div>
                            </div>
    
                        </div>
                        <div class="content1_right_container">
                            <template if:true={isImageModalOpen}>
                                <template if:true={vehicleByIdLoader2}>
                                    <div class="loader-container">
                                        <div class="spinner"></div>
                                        <p class="loading-text">Loading...</p>
                                    </div>
                                </template>
                                <template if:false={vehicleByIdLoader2}>
                                        <div class="image-display-area">
                                            <template if:true={imagesAvailable}>
                                                <template if:true={vehicleByIdLoader3}>
                                                    <div class="loader-container">
                                                        <div class="spinner"></div>
                                                        <p class="loading-text">Loading...</p>
                                                    </div>
                                                </template>
                                                <template if:false={vehicleByIdLoader3}>

                                                    <div class="image-display-top">
                                                        <img src={currentImage.fileURL} alt="Uploaded Image" />
                                                        <div class="image-pagination-container">
                                                            <!-- Previous Button -->
                                                            <template if:true={isFirstPage}>
                                                                <button class="pagination-button" onclick={showPreviousImage} disabled={isPreviousDisabled}>
                                                                    <lightning-icon icon-name="utility:chevronleft" alternative-text="Previous" size="xx-small" class="pagination-icon"></lightning-icon>
                                                                </button>
                                                            </template>
                                                        
                                                            <!-- If not on the first page, show the image icon -->
                                                            <template if:false={isFirstPage}>
                                                                <button class="pagination-button" onclick={showPreviousImage} disabled={isPreviousDisabled}>
                                                                    <lightning-icon icon-name="utility:chevronleft" alternative-text="Previous" size="xx-small" class="pagination-icon2  slds-current-color"></lightning-icon>
                                                                </button>
                                                            </template>
                                
                                                            <!-- Page Indicators -->
                                                            <div class="image-dots-container">
                                                                <template for:each={visibleDots} for:item="dot">
                                                                    <span key={dot.key} class={dot.class}></span>
                                                                </template>
                                                            </div>
                                
                                                            <!-- Next Button -->
                                                            <template if:true={isLastPage}>
                                                                <button class="pagination-button" onclick={showNextImage} disabled={isNextDisabled}>
                                                                    <lightning-icon icon-name="utility:chevronright" alternative-text="Next" size="xx-small" class="pagination-icon"></lightning-icon>
                                                                </button>
                                                            </template>
                                                        
                                                            <!-- If not on the first page, show the image icon -->
                                                            <template if:false={isLastPage}>
                                                                <button class="pagination-button" onclick={showNextImage} disabled={isNextDisabled}>
                                                                    <lightning-icon icon-name="utility:chevronright" alternative-text="Next" size="xx-small" class="pagination-icon2 slds-current-color"></lightning-icon>
                                                                </button>
                                                            </template>
                                                            <!-- <button class="pagination-button" onclick={showNextImage} disabled={isNextDisabled}>
                                                                <lightning-icon icon-name="utility:chevronright" alternative-text="Next" size="xx-small" class="pagination-icon"></lightning-icon>
                                                            </button> -->
                                                        </div>
                                                    </div>
                                                </template>
                                            </template>
                                            <template if:false={imagesAvailable}>
                                                <p>No images available.</p>
                                            </template>
                                        </div>
                                </template>
                            </template>
                            <template if:false={isImageModalOpen}>
                                <div class="loader-container">
                                    <div class="spinner"></div>
                                    <p class="loading-text">Loading...</p>
                                </div>
                            </template>
                        </div>
                        
                    </div>
    
    
    
    
                    <div class="content2_container">
                        <div class="recbar">
                            <button class="underline-button">
                                {label.CCP2_VehicleDetails}
                                <span class={classVehicleDetails}></span>
                            </button>
                            <button class="underline-button">
                                {label.CCP2_MaintenanceList}
                                <span class={classMaintainList}></span>
                            </button>
                            <button class="underline-button">
                                {label.CCP2_ExpenseManagement}
                                <span class={classCostManagement}></span>
                            </button>
                            <div class="truckonnect">
                                <p>Truckonnect</p>
                                <img src={truckLogoUrl} alt="Truckonnect"
                                    style="height:15px; width:15px; align-self:center;">
                            </div>
                        </div>
    
                        <div class="recMain no-scroll">
                            <template if:true={showVehicleDetails}>
                                <div class="vehicle_container no-scroll">
                                    <!-- <div class="vehicle_header">
                                        <h3>{label.CCP2_ChassisInformation}</h3>
                                        <h3>{label.CCP2_LoadingPlatformInformation}</h3>
                                        <h3>{label.CCP2_PartsInformation}</h3>
                                        <h3>{label.CCP2_LeaseInformation}</h3>
                                    </div> -->
                                    <div style="">
                                        <div class="vehicle_child1">
                                            <div class="vehicle_child1_container"
                                                style="border-right: 1px solid #00000014;">
                                                <div class="vehicle_child1_list">
                                                    <h3>勤務地</h3>
                                                    <h3>車台番号</h3>
                                                    <h3>車検証交付年月日</h3>
                                                    <h3>初度登録年月</h3>
                                                    <h3>自家用・事業用</h3>
                                                    <h3>車体形状</h3>
                                                </div>
                                                <div class="vehicle_child1_list">
                                                    <h3>NA</h3>
                                                    <h3>{vehicleByIdData.chassisNumber}</h3>
                                                    <h3>{vehicleByIdData.devileryDate}</h3>
                                                    <h3>{vehicleByIdData.firstRegistrationDate}</h3>
                                                    <h3>{vehicleByIdData.privateBusinessUse}</h3>
                                                    <h3>{vehicleByIdData.carBodyShape}</h3>
                                                </div>
                                            </div>
                                            <div class="vehicle_child1_container" style="padding-left: 36px;">
                                                <div class="vehicle_child1_list">
                                                    <h3>車検証画像</h3>
                                                    <h3>用途</h3>
                                                    <h3>型式</h3>
                                                    <h3>燃料の種類</h3>
                                                    <h3>車両重量</h3>
                                                    <h3>ドアナンバー</h3>
                                                </div>
                                                <div class="vehicle_child1_list">
                                                    <h3
                                                    style="color: #E10202; text-decoration:underline; white-space:nowrap; cursor: pointer;"
                                                    onclick={handleCertificateClick}>
                                                    {certificateTitleCount}
                                                  </h3>
                                                  <h3>{vehicleByIdData.purpose}</h3>
                                                  <h3>{vehicleByIdData.model}</h3>
                                                  <h3>{vehicleByIdData.typeOfFuel}</h3>
                                                  <h3>{vehicleByIdData.vehicleWeigth}kg</h3>
                                                  <h3>{vehicleByIdData.doorNumber}</h3>
                                                </div>
                                            </div>
                                            <!-- <div class="vehicle_child1_container">
                                                <div class="vehicle_child1_list">
                                                    <h3>{label.CCP2_DriversLicence}</h3>
                                                    <h3>{label.CCP2_FirstYearRegistrationDate}</h3>
                                                </div>
                                                <div class="vehicle_child1_list">
                                                    <h3>Not found</h3>
                                                    <h3>{vehicleByIdData.initialRegistrationDate}</h3>
                                                </div>
                                            </div> -->
                                        </div>
                                        <!-- <div class="vehicle_child2">{label.CCP2_LoadingPlatformInformation}</div>
                                        <div class="vehicle_child3">
                                            <div class="vehicle_child1_list">
                                                <h3>{label.CCP2_BodyMaker}</h3>
                                                <h3>{label.CCP2_BodyInternalDimmension}</h3>
                                                <h3>{label.CCP2_BodyShape}</h3>
                                                <h3>{label.CCP2_MaximumLoadingCapacity}</h3>
                                                <h3>{label.CCP2_BodyMounting}</h3>
                                            </div>
                                            <div class="vehicle_child1_list">
                                                <h3>{vehicleByIdData.bodymaker}</h3>
                                                <h3>Not found</h3>
                                                <h3>{vehicleByIdData.bodyShape}</h3>
                                                <h3>Not found</h3>
                                                <h3>Not found</h3>
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                            </template>
                            
    
                        </div>
    
    
    
                        <div class="btnrec">
                            <img src={vehicleIcon} alt="Delete Vehicle" onclick={dothis} class="bottom-icons" />
                            <span class="b">車両削除</span>
    
                            <img src={downloadIcon} alt="Download" onclick={dothis} class="bottom-icons" />
                            <!-- <lightning-button-icon icon-name="utility:print" size="medium" variant="container"
                            alternative-text={label.CCP2_Print} class="slds-m-left_small Abtn" onclick={dothis}
                            title={label.CCP2_Print}></lightning-button-icon> -->
                            <span class="b">ダウンロード</span>
    
                            <img src={editIcon} alt="Edit" onclick={dothis} class="bottom-icons" />
                            <!-- <lightning-button-icon icon-name="utility:download" size="medium" variant="container"
                                alternative-text={label.CCP2_Download} class="slds-m-left_small Abtn" onclick={dothis}
                                title={label.CCP2_Download}></lightning-button-icon> -->
                            <span class="b">編集する</span>
                        </div>
                    </div>
                </template>
    
            </div>
        </div>
    </template>
    <template if:true={isModalOpen}>
        <div class="modal-background">
            <div class="modal-window">
                <div class="modal-header">
                    <lightning-icon 
                        icon-name="utility:close" 
                        size="x-small" 
                        alternative-text="Close"
                        onclick={handleCloseModal} 
                        class="close-button">
                    </lightning-icon>
                </div>
                        <template if:true={imagesAval}>
                                <div class="upload-image-list">
                                    <template for:each={uploadImagesArray} for:item="elm">
                                        <div class={uploadImageCss} key={elm.fileName}>
                                            <div class="upload-image-top">
                                                <img src={elm.fileURL} alt="Uploaded Image" style="border-radius: 10px; height: 100%; width: 100%;" />
                                            </div>
                                            <div class="upload-image-bottom">
                                                <p class="imagetext">{elm.fileName}</p>
                                                <svg class="upload-image-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"  onclick={handleDownloadImage} data-url={elm.fileURL} data-name={elm.fileName}>
                                                    <path d="M14 11V14H2V11H0V14C0 15.1 0.9 16 2 16H14C15.1 16 16 15.1 16 14V11H14ZM13 7L11.59 5.59L9 8.17V0H7V8.17L4.41 5.59L3 7L8 12L13 7Z" fill="white"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                
                        </template>
                        <template if:false={imagesAval}>
                            <p>No images available.</p>
                        </template>
           
             
            </div>
        </div>
    </template>
    
    
    
    <template if:true={showMaintainencePage}>
        <c-ccp2-Vehicle-Maintainence-Form  veh-id={vehId}></c-ccp2-Vehicle-Maintainence-Form>
    </template>
</template>