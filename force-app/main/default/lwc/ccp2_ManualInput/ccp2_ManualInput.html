<template>
            <div class="form">
                <template if:true={Step1}>

                    <div class={formBodyCss}>
                        <div class="mainHeading" onclick={newfun}>
                            <p>車両手動登録</p>
                        </div>
                        <div class="form-container">

                            <div class="image-container">
                                <img src={truckpic} alt="Image1">
                            </div>
                            <div class="section-header">
                                <div class="mainheading2">
                                    <p>車両の情報を入力してください。</p>
                                </div>
                                <div class="header">
                                    <button class="nav-button" onclick={handlePrevious} title="Previous"
                                        disabled={isFirstPage}>
                                        <lightning-icon icon-name="utility:chevronleft" alternative-text="Previous"
                                            size="small"></lightning-icon>
                                    </button>
                                    <span class="travellingicon">
                                        <span class="page-button-color">{currentPage}</span>
                                        <span class="page-button-color-no-color">of</span>
                                        <span class="page-button-color-no-color">{totalPages}</span>
                                    </span>
                                    <button class="nav-button" onclick={handleNext} title="Next"
                                        disabled={isPageDataSavedToBackend}>
                                        <lightning-icon icon-name="utility:chevronright" alternative-text="Next"
                                            size="small"></lightning-icon>
                                    </button>
                                </div>
                            </div>
                            <div class="form-section">
                                <template if:true={formLoader}>
                                    <div style="height: 100vh; width:100vw; position:relative;">
                                        <lightning-spinner
                                            style="background-color: var(--slds-g-color-neutral-100-opacity-75, rgb(255 255 255 / 17%));"
                                            alternative-text="Loading" size="medium"></lightning-spinner>
                                    </div>
                                </template>
                                <template if:false={formLoader}>
                                    <div class="First-Section">

                                        <div class="form-group-wr">
                                            <label for="vehicleNumber">
                                                <div class="addMain">
                                                    車両番号
                                                </div>
                                            </label>
                                            <input type="text" id="vehicleNumber" class="input-field"
                                                placeholder="10桁以内で入力してください" value={formdata.vehicleNumber}
                                                name="vehicleNumber" oninput={handleInputChange} maxlength="10">
                                        </div>

                                        <div class="form-group-ChassisNumber">
                                            <label for="vehicleNumber">
                                                <div class="addMain">
                                                    車台番号
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <input type="text" class="input-field-modal chassis-color"
                                                placeholder="5桁の英数字" name="chassisNum1" data-type="part1"
                                                value={formdata.carPlatformNoPart1} oninput={handleInputChange}
                                                readonly>
                                            <span class="input-separator">
                                                -
                                            </span>
                                            <input type="text" class="input-field-modal2 chassis-color"
                                                placeholder="7桁の英数字" name="chassisNum2" data-type="part2"
                                                value={formdata.carPlatformNoPart2} oninput={handleInputChange}
                                                readonly>
                                        </div>


                                        <div class="form-group">
                                            <label for="loginNum">
                                                <div class="addMain">
                                                    登錄番号
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>

                                            <div class="input-container">
                                                
                                                <div style="display: flex; align-items:center;">
                                                <input type="text" class={errorlogin1div} placeholder="大阪" name="regNum1"
                                                    data-part="part1" value={formdata.loginNumberPart1}
                                                    onchange={handleInputChangeLoginNumber} oninput={handleInputJapanese} maxlength="24">
                                                <input type="text" class={errorlogin2div} placeholder="100" name="regNum2"
                                                    data-part="part2" value={formdata.loginNumberPart2}
                                                    onchange={handleInputChangeLoginNumber} oninput={handleInputCheck} maxlength="3">
                                                <input type="text" class={errorlogin3div} placeholder="あ" name="regNum3"
                                                    data-part="part3" value={formdata.loginNumberPart3}
                                                    onchange={handleInputChangeLoginNumber} oninput={handleInputJapanese} maxlength="1">
                                                <input type="text" class={errorlogin4div} placeholder="7284"
                                                    name="regNum4" data-part="part4" value={formdata.loginNumberPart4}
                                                    onchange={handleInputChangeLoginNumber} oninput={handleInputCheck} maxlength="4">
                                                </div>
                                                <p style="color: red; width: 21.5vw; white-space:nowrap; margin-top: 3px;" class={errorLoginCss}>{errorLogin}</p>
                                            </div>
                                        </div>


                                        <div class="form-group-wr">
                                            <label for="dateOfIssuance">
                                                <div class="addMain">
                                                    交付年月日
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="input-field" style="position: relative;">
                                                <lightning-input type="date" class="inputlight inputissue"
                                                    placeholder="日付を選択してください" name="dateOfIssuance"
                                                    value={formdata.dateOfIssuance}
                                                    onchange={handleInputChange}></lightning-input>
                                            </div>

                                        </div>
                                        <div class="form-group-wr">
                                            <label for="initialRegistrationDate">
                                                <div class="addMain">
                                                    初度登録年月
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="input-field" style="position: relative;">
                                                <lightning-input type="date" class="inputlight inputreg"
                                                    placeholder="日付を選択してください" name="initialRegistrationDate"
                                                    value={formdata.initialRegistrationDate}
                                                    onchange={handleInputChange}></lightning-input>
                                            </div>
                                        </div>
                                        <div class="form-group-wr">
                                            <label for="expirationDate">
                                                <div class="addMain">
                                                    有効期間の満了日
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>

                                            <div class="input-field" style="position: relative;">
                                                <lightning-input type="date" class="inputlight inputexp"
                                                    placeholder="日付を選択してください" name="expirationDate"
                                                    value={formdata.expirationDate}
                                                    onchange={handleInputChange}></lightning-input>
                                            </div>

                                        </div>
                                        <div class="form-group WorkLocation">

                                            <label for="WorkLocation">
                                                <div class="addMain">
                                                    車名
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>

                                            <div class="Combox-input-wr">

                                                <div class="dropdown">
                                                    <input type="text" onclick={handleCarNameChange} autocomplete="off"
                                                        class="InputsCarName Inputs1 icon2 " placeholder="選択してください"
                                                        value={selectedPicklistCarName} name="carName" readonly>
                                                    <template if:true={showlistCarName}>
                                                        <div class="listCarName lists2 no-scroll" name="carName"
                                                            onclick={handleInsideClick}>
                                                            <template for:each={carNameOptions} for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange} data-namee="carName"
                                                                    data-idd={veh.label}>
                                                                    <p data-namee="carName" data-idd={veh.label}>
                                                                        {veh.label}</p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group-wr">
                                            <label for="branch">
                                                <div class="addMain">
                                                    自動車の種別
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="Combox-input-wr">

                                                <div class="dropdown">
                                                    <input type="text" onclick={handletypeOfVehicleChange}
                                                        autocomplete="off" class="Inputstypeofvehicle Inputs1 icon2"
                                                        placeholder="選択してください" value={selectedPicklisttypeOfVehicle}
                                                        name="typeOfVehicle" readonly>
                                                    <template if:true={showlisttypeOfVehicle}>
                                                        <div class="listtypeofvehicle lists2 no-scroll"
                                                            name="typeOfVehicle" onclick={handleInsideClick}>
                                                            <template for:each={vehicleTypeOptions} for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange}
                                                                    data-namee="typeOfVehicle" data-idd={veh.label}>
                                                                    <p data-namee="typeOfVehicle" data-idd={veh.label}>
                                                                        {veh.label}</p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group-wr">
                                            <label for="Type of Car">
                                                <div class="addMain">
                                                    ドアナンバー

                                                </div>

                                            </label>


                                            <div class="Combox-input-wr">
                                                <div>
                                                    <input type="text" id="DoorNum" class={errorDoorDiv}
                                                        placeholder="選択してください" value={formdata.doorNumber}
                                                        name="doorNumber" onchange={handleInputChange} maxlength="10">
                                                    <p style="color: red; margin-top: 3px;" class={errorDoorCss}>{errorDoor}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group-wr">
                                            <label for="CarName">
                                                <div class="addMain">
                                                    燃料のタイプ
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="Combox-input-wr">

                                                <div class="dropdownfuel">
                                                    <input type="text" onclick={handlefuelTypeChange} autocomplete="off"
                                                        class="InputsfuelType Inputs1 icon2" placeholder="選択してください"
                                                        value={selectedPicklistfuelType} name="fuelType" readonly>
                                                    <template if:true={showlistfuelType}>
                                                        <div class="listfueltype lists2 no-scroll" name="fuelType"
                                                            onclick={handleInsideClick}>
                                                            <template for:each={fuelTypeOptions} for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange} data-namee="fuelType"
                                                                    data-idd={veh.label}>
                                                                    <p data-namee="fuelType" data-idd={veh.label}>
                                                                        {veh.label}</p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Second-Section">
                                        <div class="form-group form-margin">
                                            <label for="VehicleInspectionImage">
                                                <div class="addMain">
                                                    車検証画像
                                                    <span class="reqtxt">必須</span>
                                                </div>

                                            </label>
                                            <section id="VehicleInspectionImage" class={uploadDivCss1}
                                                onclick={opencertmodal}>
                                                <template if:true={uploadIconToggle1}>
                                                    <img src={uplpic} width="20px" height="16px" />
                                                </template>
                                                <p>{uploadText1}</p>
                                            </section>

                                        </div>
                                        <div class="form-group-wr form-margin">
                                            <label for="VehicleImage">
                                                <div class="addMain">
                                                    車両写真
                                                </div>

                                            </label>
                                            <section class={uploadDivCss2} onclick={showupload}>
                                                <template if:true={uploadIconToggle2}>
                                                    <img src={uplpic} width="20px" height="16px" />
                                                </template>
                                                <p>{uploadText2}</p>
                                            </section>

                                        </div>

                                        <div class="form-group-ChassisNumber form-margin">
                                            <label for="Model">
                                                <div class="addMain">
                                                    型式
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="model-div-container">
                                                <div style="display: flex; align-items:center;">
                                                    <div>
                                                        <input type="text" class={errorModelDiv} placeholder="US9"
                                                            value={formdata.model1} name="model1" onchange={handleInputChange}
                                                            maxlength="3">
                                                        <!-- <p style="color: red; width: 10.2vw;" class={errorModelCss}>{errorModel}
                                                        </p> -->
                                                    </div>
                                                    <span class="input-separator"> - </span>
                                                    <div>
                                                        <input type="text" class={errorModelDiv} placeholder="48I5"
                                                            value={formdata.model2} name="model2" onchange={handleInputChange}
                                                            maxlength="7">
                                                        <!-- <p style="color: red; width: 10.2vw;" class={errorModelCss}>{errorModel}
                                                        </p> -->
                                                    </div>
                                                </div>
                                                <p style="color: red; width: 21.5vw; white-space:nowrap; margin-top: 3px;" class={errorModelCss}>{errorModel}
                                                </p>
                                            </div>
                                        </div>

                                        <div class="form-group form-margin">
                                            <label for="PrivateBusiness">
                                                <div class="addMain">
                                                    自家用・事業用
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>

                                            <div class="Combox-input">

                                                <div class="dropdown">
                                                    <input type="text" onclick={handleprivateOrBusinessUseChange}
                                                        autocomplete="off"
                                                        class="Inputsprivateorbussiness Inputs1 icon2"
                                                        placeholder="選択してください"
                                                        value={selectedPicklistprivateOrBusinessUse}
                                                        name="privateOrBusinessUse" readonly>
                                                    <template if:true={showlistprivateOrBusinessUse}>
                                                        <div class="listprivateOrBusinessUse lists2 no-scroll"
                                                            name="privateOrBusinessUse" onclick={handleInsideClick}>
                                                            <template for:each={privateOrBusinessOptions}
                                                                for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange}
                                                                    data-namee="privateOrBusinessUse"
                                                                    data-idd={veh.label}>
                                                                    <p data-namee="privateOrBusinessUse"
                                                                        data-idd={veh.label}>
                                                                        {veh.label}</p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group form-margin">
                                            <label for="BodyShape">
                                                <div class="addMain">
                                                    車体の形状
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="Combox-input-wr">

                                                <div class="dropdown">
                                                    <input type="text" onclick={handlebodyShapeChange}
                                                        autocomplete="off" class="Inputsbodyshape Inputs1 icon2"
                                                        placeholder="選択してください" value={selectedPicklistbodyShape}
                                                        name="bodyShape" readonly>
                                                    <template if:true={showlistbodyShape}>
                                                        <div class="listbodyshape lists2 no-scroll" name="bodyShape"
                                                            onclick={handleInsideClick}>
                                                            <template for:each={bodyShapeOptions} for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange}
                                                                    data-namee="bodyShape" data-idd={veh.label}>
                                                                    <p data-namee="bodyShape" data-idd={veh.label}>
                                                                        {veh.label}</p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group form-margin">
                                            <label for="Use">
                                                <div class="addMain">
                                                    用途
                                                    <span class="reqtxt">必須</span>
                                                </div>

                                            </label>

                                            <div class="Combox-input">

                                                <div class="dropdown">
                                                    <input type="text" onclick={handleuseChange}
                                                        class="Inputsuse Inputs1 icon2 " autocomplete="off"
                                                        placeholder="選択してください" value={selectedPicklistuse} name="use"
                                                        readonly>
                                                    <template if:true={showlistuse}>
                                                        <div class="listuse lists2 no-scroll" name="use"
                                                            onclick={handleInsideClick}>
                                                            <template for:each={useOptions} for:item="veh">
                                                                <div key={veh.label} class="list-item"
                                                                    onclick={handlePickListChange} data-namee="use"
                                                                    data-idd={veh.label}>
                                                                    <p data-namee="use" data-idd={veh.label}>{veh.label}
                                                                    </p>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group-wr form-margin">
                                            <label for="mileage">
                                                <div class="addMain">
                                                    走行距離
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div>
                                                <input type="text" id="Mileage" class={errorMileageDiv}
                                                    placeholder="選択してください" value={formdata.mileage} name="mileage"
                                                    onchange={handleInputChange} oninput={handleInputCheck} maxlength="6">
                                                <p style="color: red;  margin-top: 3px;" class={errorMileageCss}>{errorMileage}</p>
                                            </div>
                                            <span class="unit">Km</span>

                                        </div>

                                        <div class="form-group-wr second-last-second-section">
                                            <label for="Weight">
                                                <div class="addMain">
                                                    車両重量
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div>
                                                <input type="text" id="Weight" class={errorCurbDiv}
                                                    placeholder="選択してください" value={formdata.curbWeight} name="curbWeight"
                                                    onchange={handleInputChange} oninput={handleInputCheck} maxlength="4">

                                                <p style="color: red;  margin-top: 3px;" class={errorCurbCss}>{errorCurb}</p>
                                            </div>
                                            <span class="unit">Kg</span>
                                        </div>

                                        <div class="form-group-branch">
                                            <label for="branches">
                                                <div class="addMain branch">
                                                    所属
                                                    <span class="reqtxt">必須</span>
                                                </div>
                                            </label>
                                            <div class="dataDrop">
                                                <input type="text" onclick={handlevehChange} readonly
                                                    class="Inputs12 icon"
                                                    placeholder="選択する">
                                                <template if:true={showlist}>
                                                    <div class="lists no-scroll" onclick={handleInsideClick}>
                                                        <template for:each={branches} for:item="veh">
                                                            <div key={veh.value} class="list-item"
                                                                onclick={handleBranchSelect} data-id={veh.value}>
                                                                <p>{veh.label}</p>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </template>
                                            </div>
                                            <div class="dataScroll">
                                                <div class="scrollbar">
                                                    <template if:true={hasVehicles2}>
                                                        <template for:each={selectedbranches} for:item="veh">
                                                            <div key={veh.value} class="record-item">
                                                                <lightning-icon icon-name="utility:close" size="x-small"
                                                                    alternative-text="Delete"
                                                                    onclick={handleDeleteBranch} data-id={veh.value}
                                                                    class="filtericn"></lightning-icon>
                                                                <span class="vehicleInBox">{veh.label}</span>
                                                                <br>
                                                            </div>
                                                        </template>
                                                    </template>
                                                    <template if:false={hasVehicles2}>
                                                        <p class="empty1">選択された</p>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                            <div class="form-footer">
                                <div class="button cancel-btn">
                                    <div class="btn" onclick={showexit}>
                                        <P class="toedit">出口</P>
                                        <!-- cancel -->
                                    </div>
                                </div>

                                <div style="display: flex; justify-content:right; align-items:center; gap:25px">
                                    <button style="background-color: white; color:black; border:1px solid #bfbfbf;"
                                        class={finalCompletionButtonCss} name="completion-button"
                                        onclick={handleSaveData} disabled={disableSaveButton}>完了</button>


                                    <template if:false={isLastPage}>

                                        <button class="searchbutton btn buttontxt2 searchbuttonnew" name="next-button"
                                            style="color: white;" disabled={disableSaveButton}
                                            onclick={handleSaveData}>保存して次へ</button>

                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
                <template if:true={showRegisteredVehicles}>
                    <div class="container2">
                        <div class="mainHeading">
                            <h1>車両手動登録</h1>
                        </div>
                        <div class="content2">
                            <p>車両が登録されました。</p>
                        </div>
                        <div class="footer2">
                            <button class="searchbutton btn" onclick={handleClick}>車両一覧へ</button>
                        </div>
                    </div>
                </template>
            </div>

            

    <template if:true={showfinalModal}>
        <div class="modal-background">
            <div class="modal-background-confirm">
                <div class="heads">

                    <template if:true={missingChassisNumbers.length}>
                        <h3 class="headmeow gaps">下記の車両の情報がまだ入力されていません。</h3>
                        <ul>
                            <template for:each={missingChassisNumbers} for:item="chassis">
                                <li class="superfun" key={chassis}>{chassis}</li>
                            </template>
                        </ul>
                    </template>
                    <template if:true={commonChassisNumbers.length}>
                        <h3 class="headmeow">下記の車両だけ登録しますか？</h3>

                        <ul>
                            <template for:each={commonChassisNumbers} for:item="chassis">
                                <li class="superfun" key={chassis}>{chassis}</li>
                            </template>
                        </ul>
                    </template>

                </div>
                <div class="buttons-small">
                    <div class="cancelbutton btn" onclick={closesure}>
                        <p class="buttontxt">いいえ</p>
                    </div>
                    <div class="searchbutton btn" onclick={handleShowRegisteredVehiclesFinalScreem}>
                        <p class="buttontxt2">はい</p>
                    </div>
                </div>
            </div>
        </div>
    </template>
    <template if:true={showUploadModal}>
        <div class="modal-background">
            <div class="modal-window">
                <c-ccp2-_-Vehicle-Image-Upload onupdateitems={getimagedata} onupdateids={getImageIdsForClass}
                    onclosemodal={closeupload} image-data={imageDataToSendBack}></c-ccp2-_-Vehicle-Image-Upload>
            </div>
        </div>
    </template>
    <template if:true={showUploadCModal}>
        <div class="modal-background">
            <div class="modal-window2">
                <c-ccp2-_-Vehicle-Certificate-Upload onupdateitems={getimagecertdata}
                    onupdateids={getCertificateIdsForClass} onclosemodal={closecertficate}
                    image-data={certificateDataToSendBack}></c-ccp2-_-Vehicle-Certificate-Upload>
            </div>
        </div>
    </template>
    <template if:true={showexitModal}>
        <div class="modal-background">
            <div class="modal-background-exit">
                <div
                    style=" color: #262626; height: 54px; width: 328px; font-weight: 400; line-height: 27px; font-size: 18px; display: flex; justify-content: center; align-items: center; margin: auto;">
                    未アップロードの車両が残っています、
                    車両登録を終了しますか？</div>
                <div class="heads heads-exit">

                    <center>
                        <h1 class="exittest">終了しますか？</h1>
                    </center>
                    <template if:true={missingChassisNumbers.length}>
                        <h3 class="headmeow gaps">下記の車両の情報がまだ入力されていません。</h3>
                        <ul>
                            <template for:each={missingChassisNumbers} for:item="chassis">
                                <li class="superfun" key={chassis}>{chassis}</li>
                            </template>
                        </ul>
                    </template>
                    <template if:true={commonChassisNumbers.length}>
                        <h3 class="headmeow">下記の車両だけ登録しますか？</h3>
                        <ul>
                            <template for:each={commonChassisNumbers} for:item="chassis">
                                <li class="superfun" key={chassis}>{chassis}</li>
                            </template>
                        </ul>
                    </template>
                </div>
                <div class="buttons-small">
                    <div class="cancelbutton btn" onclick={Closeexit}>
                        <p class="buttontxt">いいえ</p>
                    </div>
                    <div class="searchbutton btn" onclick={handleClick}>
                        <p class="buttontxt2">はい</p>
                    </div>
                </div>
            </div>
        </div>
    </template>


</template>